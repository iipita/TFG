---
title: "TFG"
output: html_document
---
```{r}
install.packages('tidyverse')
install.packages('gtrendsR')
install.packages('RJDemetra')
install.packages('rJava')
```
```{r}

```

```{r}
if(!require(installr)) {
  install.packages("installr"); 
  require(installr)
}
updateR(F, T, T, F, T, F, T)



install.packages("remotes")
remotes::install_github("trendecon/trendecon")

```
```{r}
devtools::install_github("jdemetra/rjdemetra")
}
```


```{r}
library(readxl)
library(tidyr)
library(gtrendsR)
library(Rcpp)
library(corrplot)
library(trendecon)
library(RJDemetra)
library(FactoMineR)
library(factoextra)
library(forecast)
library(DescTools)
library(stats)
```
```{r}
Spain <- read_excel("C:/Users/inigo/OneDrive/Escritorio/4ºCD/TFG/Spain.xlsx",
    col_types = c("date", "text", "text", 
        "text", "text", "text", "text", "text"))
SpainESI = Spain[,-c(2,3,4,5,6)]
SpainESI = SpainESI[-(0:264),]
SpainESI$ES.ESI = as.numeric(SpainESI$ES.ESI)
ESI = SpainESI[,-3]
```
Crisis = gtrends(keyword = 'Crisis', geo = 'ES', time = ('2007-01-01 2022-02-28'))
CrisisEco = gtrends(keyword = 'Crisis economica', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Cortoplazo = gtrends(keyword = 'Trabajo a corto plazo', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Desempleado = gtrends(keyword = 'Desempleado', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Quiebra = gtrends(keyword = 'Quiebra', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Ahorrar = gtrends(keyword = 'Ahorrar', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Amazon = gtrends(keyword = 'Amazon', geo = 'ES', time = ('2007-01-01 2022-02-28'))
AutoScout24 = gtrends(keyword = 'AutoScout24', geo = 'ES', time = ('2007-01-01 2022-02-28'))
CPARO = gtrends(keyword = 'Cobrar el PARO', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Comprar = gtrends(keyword = 'Comprar', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Construccion = gtrends(keyword = 'Construccion', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Desempleo = gtrends(keyword = 'Desempleo', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Emprender = gtrends(keyword = 'Emprender', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Idealista = gtrends(keyword = 'Idealista', geo = 'ES', time = ('2007-01-01 2022-02-28'))
IKEA = gtrends(keyword = 'IKEA', geo = 'ES', time = ('2007-01-01 2022-02-28'))
InfoJobs = gtrends(keyword = 'InfoJobs', geo = 'ES', time = ('2007-01-01 2022-02-28'))
LinkedIn = gtrends(keyword = 'LinkedIn', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Prima = gtrends(keyword = 'Materia Prima', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Paro = gtrends(keyword = 'Paro', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Rebajas = gtrends(keyword = 'Rebajas', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Recesion = gtrends(keyword = 'Recesion economica', geo = 'ES', time = ('2007-01-01 2022-02-28'))
Bancarota = gtrends(keyword = 'Bancarrota', geo = 'ES', time = ('2007-01-01 2022-02-28'))



```
Analisis de correlacion 
```{r}
Analisis = data.frame(as.numeric(SpainESI$ES.ESI), Ahorrar[["interest_over_time"]][["hits"]], Amazon[["interest_over_time"]][["hits"]], AutoScout24[["interest_over_time"]][["hits"]], Comprar[["interest_over_time"]][["hits"]], Construccion[["interest_over_time"]][["hits"]], CPARO[["interest_over_time"]][["hits"]], Crisis[["interest_over_time"]][["hits"]], Desempleo[["interest_over_time"]][["hits"]], Emprender[["interest_over_time"]][["hits"]], Idealista[["interest_over_time"]][["hits"]], IKEA[["interest_over_time"]][["hits"]], InfoJobs[["interest_over_time"]][["hits"]], as.numeric(LinkedIn[["interest_over_time"]][["hits"]]), Paro[["interest_over_time"]][["hits"]], Prima[["interest_over_time"]][["hits"]], Rebajas[["interest_over_time"]][["hits"]], Recesion[["interest_over_time"]][["hits"]], CrisisEco[["interest_over_time"]][["hits"]], Cortoplazo[["interest_over_time"]][["hits"]], Desempleado[["interest_over_time"]][["hits"]], Bancarota[["interest_over_time"]][["hits"]], Quiebra[["interest_over_time"]][["hits"]] )
Analisis[is.na(Analisis)] <- 0
m = cor(Analisis)
corrplot(m, 'ellipse')
```

ESPAÑA:

```{r}
###crisis = ts_gtrends(keyword = 'crisis', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###desempleo = ts_gtrends(keyword = 'desempleo', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###quiebra = ts_gtrends(keyword = 'quiebra', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###infojobs = ts_gtrends(keyword = 'infojobs', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###comprar = ts_gtrends(keyword = 'comprar', geo = 'ES', time = ('2007-01-01 2022-02-28'))
```

```{r}
###crisis2 = ts_gtrends(keyword = 'crisis', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###desempleo2 = ts_gtrends(keyword = 'desempleo', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###quiebra2 = ts_gtrends(keyword = 'quiebra', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###infojobs2 = ts_gtrends(keyword = 'infojobs', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###comprar2 = ts_gtrends(keyword = 'comprar', geo = 'ES', time = ('2007-01-01 2022-02-28'))
```

```{r}
###crisis3 = ts_gtrends(keyword = 'crisis', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###desempleo3 = ts_gtrends(keyword = 'desempleo', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###quiebra3 = ts_gtrends(keyword = 'quiebra', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###infojobs3 = ts_gtrends(keyword = 'infojobs', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###comprar3 = ts_gtrends(keyword = 'comprar', geo = 'ES', time = ('2007-01-01 2022-02-28'))
```

```{r}
###crisis4 = ts_gtrends(keyword = 'crisis', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###desempleo4 = ts_gtrends(keyword = 'desempleo', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###quiebra4 = ts_gtrends(keyword = 'quiebra', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###infojobs4 = ts_gtrends(keyword = 'infojobs', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###comprar4 = ts_gtrends(keyword = 'comprar', geo = 'ES', time = ('2007-01-01 2022-02-28'))
```

```{r}
###crisis5 = ts_gtrends(keyword = 'crisis', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###desempleo5 = ts_gtrends(keyword = 'desempleo', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###quiebra5 = ts_gtrends(keyword = 'quiebra', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###infojobs5 = ts_gtrends(keyword = 'infojobs', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###comprar5 = ts_gtrends(keyword = 'comprar', geo = 'ES', time = ('2007-01-01 2022-02-28'))
```

```{r}
###crisis6 = ts_gtrends(keyword = 'crisis', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###desempleo6 = ts_gtrends(keyword = 'desempleo', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###quiebra6 = ts_gtrends(keyword = 'quiebra', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###infojobs6 = ts_gtrends(keyword = 'infojobs', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###comprar6 = ts_gtrends(keyword = 'comprar', geo = 'ES', time = ('2007-01-01 2022-02-28'))
```

```{r}
###crisis7 = ts_gtrends(keyword = 'crisis', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###desempleo7 = ts_gtrends(keyword = 'desempleo', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###quiebra7 = ts_gtrends(keyword = 'quiebra', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###infojobs7 = ts_gtrends(keyword = 'infojobs', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###comprar7 = ts_gtrends(keyword = 'comprar', geo = 'ES', time = ('2007-01-01 2022-02-28'))
```

```{r}
###crisis8 = ts_gtrends(keyword = 'crisis', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###desempleo8 = ts_gtrends(keyword = 'desempleo', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###quiebra8 = ts_gtrends(keyword = 'quiebra', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###infojobs8 = ts_gtrends(keyword = 'infojobs', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###comprar8 = ts_gtrends(keyword = 'comprar', geo = 'ES', time = ('2007-01-01 2022-02-28'))
```

```{r}
###crisis9 = ts_gtrends(keyword = 'crisis', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###desempleo9 = ts_gtrends(keyword = 'desempleo', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###quiebra9 = ts_gtrends(keyword = 'quiebra', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###infojobs9 = ts_gtrends(keyword = 'infojobs', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###comprar9 = ts_gtrends(keyword = 'comprar', geo = 'ES', time = ('2007-01-01 2022-02-28'))
```

```{r}
###crisis10 = ts_gtrends(keyword = 'crisis', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###desempleo10 = ts_gtrends(keyword = 'desempleo', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###quiebra10 = ts_gtrends(keyword = 'quiebra', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###infojobs10 = ts_gtrends(keyword = 'infojobs', geo = 'ES', time = ('2007-01-01 2022-02-28'))
###comprar10 = ts_gtrends(keyword = 'comprar', geo = 'ES', time = ('2007-01-01 2022-02-28'))
```

```{r}
crisism = data.frame(crisis[,2], crisis2[,2],crisis3[,2], crisis4[,2], crisis5[,2], crisis6[,2], crisis7[,2], crisis8[,2], crisis9[,2], crisis10[,2])
for (i in c(1:182)){
  t = mean(c(crisism[i,1],crisism[i,2],crisism[i,3],crisism[i,4],crisism[i,5],crisism[i,6], crisism[i,7],         crisism[i,8], crisism[i,9], crisism[i,10]))
  crisisF[i] = t} 

```

```{r}

```{r}
comprarm = data.frame(comprar[,2], comprar2[,2],comprar3[,2], comprar4[,2], comprar5[,2], comprar6[,2], comprar7[,2], comprar8[,2], comprar9[,2], comprar10[,2])
for (i in c(1:182)){
  t = mean(c(comprarm[i,1],comprarm[i,2],comprarm[i,3],comprarm[i,4],comprarm[i,5],comprarm[i,6], comprarm[i,7],         comprarm[i,8], comprarm[i,9], comprarm[i,10]))
  comprarF[i] = t} 

```

```{r}
desempleom = data.frame(desempleo[,2], desempleo2[,2],desempleo3[,2], desempleo4[,2], desempleo5[,2], desempleo6[,2], desempleo7[,2], desempleo8[,2], desempleo9[,2], desempleo10[,2])
for (i in c(1:182)){
  t = mean(c(desempleom[i,1],desempleom[i,2],desempleom[i,3],desempleom[i,4],desempleom[i,5],desempleom[i,6], desempleom[i,7],desempleom[i,8], desempleom[i,9], desempleom[i,10]))
  desempleoF[i] = t} 

```

```{r}
infojobsm = data.frame(infojobs[,2], infojobs2[,2],infojobs3[,2], infojobs4[,2], infojobs5[,2], infojobs6[,2], infojobs7[,2], infojobs8[,2], infojobs9[,2], infojobs10[,2])
for (i in c(1:182)){
  t = mean(c(infojobsm[i,1],infojobsm[i,2],infojobsm[i,3],infojobsm[i,4],infojobsm[i,5],infojobsm[i,6], infojobsm[i,7], infojobsm[i,8], infojobsm[i,9], infojobsm[i,10]))
  infojobsF[i] = t} 

```

```{r}
quiebram = data.frame(quiebra[,2], quiebra2[,2],quiebra3[,2], quiebra4[,2], quiebra5[,2], quiebra6[,2], quiebra7[,2], quiebra8[,2], quiebra9[,2], quiebra10[,2])
for (i in c(1:182)){
  t = mean(c(quiebram[i,1],quiebram[i,2],quiebram[i,3],quiebram[i,4],quiebram[i,5],quiebram[i,6], quiebram[i,7],         quiebram[i,8], quiebram[i,9], quiebram[i,10]))
  quiebraF[i] = t} 

```

```{r}
serie_crisis = ts(crisisF, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleo = ts(desempleoF, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebra = ts(quiebraF, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobs = ts(infojobsF, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprar = ts(comprarF, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_esi = ts(ESI$ES.ESI, frequency = 12, start = c(2007,1), end = c(2022,2))
```

```{r}
mysa_crisis <- x13(serie_crisis, spec = "RSA5c")
mysa_desempleo <- x13(serie_desempleo, spec = "RSA5c")
mysa_quiebra <- x13(serie_quiebra, spec = "RSA5c")
mysa_infojobs <- x13(serie_infojobs, spec = "RSA5c")
mysa_comprar <- x13(serie_comprar, spec = "RSA5c")
```

```{r}
data = data.frame(mysa_crisis[["final"]][["series"]][,2], mysa_desempleo[["final"]][["series"]][,2], mysa_quiebra[["final"]][["series"]][,2], mysa_infojobs[["final"]][["series"]][,2], mysa_comprar[["final"]][["series"]][,2])
#res.pca = PCA(data, scale.unit = TRUE, graph = FALSE, ncp = 5)
pca = prcomp(data, scale = TRUE)
#eig.val <- get_eigenvalue(res.pca)
#fviz_eig(res.pca)
Var_pca = pca[["x"]]
```

```{r}
dim1 = ts(Var_pca[,1], frequency = 12, start = c(2007,1), end = c(2022,2))
dim2 = ts(Var_pca[,2], frequency = 12, start = c(2007,1), end = c(2022,2))
dim3 = ts(Var_pca[,3], frequency = 12, start = c(2007,1), end = c(2022,2))
```

```{r}
regresion = lm(ESI$ES.ESI ~ dim1 + dim2+ dim3)
summary(regresion)
interseccion = regresion[["coefficients"]][["(Intercept)"]]
beta1 = regresion[["coefficients"]][["dim1"]]
beta2 = regresion[["coefficients"]][["dim2"]]
beta3 = regresion[["coefficients"]][["dim3"]]
```

Evaluacion
```{r}
MAE = MAE(regresion, ESI$ES.ESI)
MAPE = MAPE(regresion, ESI$ES.ESI)
RMSE = RMSE(regresion, ESI$ES.ESI)
```
COMUNIDAD VALENCIANA:
```{r}
serie_crisisVLC = ts(crisisVLC$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoVLC = ts(desempleoVLC$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraVLC = ts(quiebraVLC$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsVLC = ts(infojobsVLC$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarVLC = ts(comprarVLC$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisVLC <- x13(serie_crisisVLC, spec = "RSA5c")
mysa_desempleoVLC <- x13(serie_desempleoVLC, spec = "RSA5c")
mysa_quiebraVLC <- x13(serie_quiebraVLC, spec = "RSA5c")
mysa_infojobsVLC <- x13(serie_infojobsVLC, spec = "RSA5c")
mysa_comprarVLC <- x13(serie_comprarVLC, spec = "RSA5c")

dataVLC = data.frame(mysa_crisisVLC[["final"]][["series"]][,2], mysa_desempleoVLC[["final"]][["series"]][,2], mysa_quiebraVLC[["final"]][["series"]][,2], mysa_infojobsVLC[["final"]][["series"]][,2], mysa_comprarVLC[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanorm = dataVLC
for (i in c(1:5)){
  t = (dataVLC[,i]-mean(dataVLC[,i])) / sd(dataVLC[,i])
  pcanorm[,i] = t
}
VLCPC1 = pcanorm[,1] * pca$rotation[1,1] + pcanorm[,2] * pca$rotation[2,1] + pcanorm[,3] * pca$rotation[3,1] + pcanorm[,4] * pca$rotation[4,1] + pcanorm[,5] * pca$rotation[5,1]
VLCPC2 = pcanorm[,1] * pca$rotation[1,2] + pcanorm[,2] * pca$rotation[2,2] + pcanorm[,3] * pca$rotation[3,2] + pcanorm[,4] * pca$rotation[4,2] + pcanorm[,5] * pca$rotation[5,2]
VLCPC3 = pcanorm[,1] * pca$rotation[1,3] + pcanorm[,2] * pca$rotation[2,3] + pcanorm[,3] * pca$rotation[3,3] + pcanorm[,4] * pca$rotation[4,3] + pcanorm[,5] * pca$rotation[5,3]

ESIVLC = NULL
for (i in c(1:182)){
  ESIVLC[i] =  interseccion + (beta1 * VLCPC1[i]) + (beta2 * VLCPC2[i]) + (beta3 * VLCPC3[i])
}

ESIVLC = ts(ESIVLC, frequency = 12, start = c(2007,1), end = c(2022,2))
```

Madrid
```{r}
serie_crisisMAD = ts(crisisMAD$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoMAD = ts(desempleoMAD$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraMAD = ts(quiebraMAD$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsMAD = ts(infojobsMAD$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarMAD = ts(comprarMAD$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisMAD <- x13(serie_crisisMAD, spec = "RSA5c")
mysa_desempleoMAD <- x13(serie_desempleoMAD, spec = "RSA5c")
mysa_quiebraMAD <- x13(serie_quiebraMAD, spec = "RSA5c")
mysa_infojobsMAD <- x13(serie_infojobsMAD, spec = "RSA5c")
mysa_comprarMAD <- x13(serie_comprarMAD, spec = "RSA5c")

dataMAD = data.frame(mysa_crisisMAD[["final"]][["series"]][,2], mysa_desempleoMAD[["final"]][["series"]][,2], mysa_quiebraMAD[["final"]][["series"]][,2], mysa_infojobsMAD[["final"]][["series"]][,2], mysa_comprarMAD[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormMAD = dataMAD
for (i in c(1:5)){
  t = (dataMAD[,i]-mean(dataMAD[,i])) / sd(dataMAD[,i])
  pcanormMAD[,i] = t
}
MADPC1 = pcanormMAD[,1] * pca$rotation[1,1] + pcanormMAD[,2] * pca$rotation[2,1] + pcanormMAD[,3] * pca$rotation[3,1] + pcanormMAD[,4] * pca$rotation[4,1] + pcanormMAD[,5] * pca$rotation[5,1]
MADPC2 = pcanormMAD[,1] * pca$rotation[1,2] + pcanormMAD[,2] * pca$rotation[2,2] + pcanormMAD[,3] * pca$rotation[3,2] + pcanormMAD[,4] * pca$rotation[4,2] + pcanormMAD[,5] * pca$rotation[5,2]
MADPC3 = pcanormMAD[,1] * pca$rotation[1,3] + pcanormMAD[,2] * pca$rotation[2,3] + pcanormMAD[,3] * pca$rotation[3,3] + pcanormMAD[,4] * pca$rotation[4,3] + pcanormMAD[,5] * pca$rotation[5,3]

ESIMAD = NULL
for (i in c(1:182)){
  ESIMAD[i] =  interseccion + (beta1 * MADPC1[i]) + (beta2 * MADPC2[i]) + (beta3 * MADPC3[i])
}

ESIMAD = ts(ESIMAD, frequency = 12, start = c(2007,1), end = c(2022,2))
```
Andalucia:
```{r}
serie_crisisAN = ts(crisisAN$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoAN = ts(desempleoAN$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraAN = ts(quiebraAN$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsAN = ts(infojobsAN$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarAN = ts(comprarAN$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisAN <- x13(serie_crisisAN, spec = "RSA5c")
mysa_desempleoAN <- x13(serie_desempleoAN, spec = "RSA5c")
mysa_quiebraAN <- x13(serie_quiebraAN, spec = "RSA5c")
mysa_infojobsAN <- x13(serie_infojobsAN, spec = "RSA5c")
mysa_comprarAN <- x13(serie_comprarAN, spec = "RSA5c")

dataAN = data.frame(mysa_crisisAN[["final"]][["series"]][,2], mysa_desempleoAN[["final"]][["series"]][,2], mysa_quiebraAN[["final"]][["series"]][,2], mysa_infojobsAN[["final"]][["series"]][,2], mysa_comprarAN[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormAN = dataAN
for (i in c(1:5)){
  t = (dataAN[,i]-mean(dataAN[,i])) / sd(dataAN[,i])
  pcanormAN[,i] = t
}
ANPC1 = pcanormAN[,1] * pca$rotation[1,1] + pcanormAN[,2] * pca$rotation[2,1] + pcanormAN[,3] * pca$rotation[3,1] + pcanormAN[,4] * pca$rotation[4,1] + pcanormAN[,5] * pca$rotation[5,1]
ANPC2 = pcanormAN[,1] * pca$rotation[1,2] + pcanormAN[,2] * pca$rotation[2,2] + pcanormAN[,3] * pca$rotation[3,2] + pcanormAN[,4] * pca$rotation[4,2] + pcanormAN[,5] * pca$rotation[5,2]
ANPC3 = pcanormAN[,1] * pca$rotation[1,3] + pcanormAN[,2] * pca$rotation[2,3] + pcanormAN[,3] * pca$rotation[3,3] + pcanormAN[,4] * pca$rotation[4,3] + pcanormAN[,5] * pca$rotation[5,3]

ESIAN = NULL
for (i in c(1:182)){
  ESIAN[i] =  interseccion + (beta1 * ANPC1[i]) + (beta2 * ANPC2[i]) + (beta3 * ANPC3[i])
}

ESIAN = ts(ESIAN, frequency = 12, start = c(2007,1), end = c(2022,2))
```
ARAGON:
```{r}
serie_crisisAR = ts(crisisAR$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoAR = ts(desempleoAR$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraAR = ts(quiebraAR$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsAR = ts(infojobsAR$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarAR = ts(comprarAR$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisAR <- x13(serie_crisisAR, spec = "RSA5c")
mysa_desempleoAR <- x13(serie_desempleoAR, spec = "RSA5c")
mysa_quiebraAR <- x13(serie_quiebraAR, spec = "RSA5c")
mysa_infojobsAR <- x13(serie_infojobsAR, spec = "RSA5c")
mysa_comprarAR <- x13(serie_comprarAR, spec = "RSA5c")

dataAR = data.frame(mysa_crisisAR[["final"]][["series"]][,2], mysa_desempleoAR[["final"]][["series"]][,2], mysa_quiebraAR[["final"]][["series"]][,2], mysa_infojobsAR[["final"]][["series"]][,2], mysa_comprarAR[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormAR = dataAR
for (i in c(1:5)){
  t = (dataAR[,i]-mean(dataAR[,i])) / sd(dataAR[,i])
  pcanormAR[,i] = t
}
ARPC1 = pcanormAR[,1] * pca$rotation[1,1] + pcanormAR[,2] * pca$rotation[2,1] + pcanormAR[,3] * pca$rotation[3,1] + pcanormAR[,4] * pca$rotation[4,1] + pcanormAR[,5] * pca$rotation[5,1]
ARPC2 = pcanormAR[,1] * pca$rotation[1,2] + pcanormAR[,2] * pca$rotation[2,2] + pcanormAR[,3] * pca$rotation[3,2] + pcanormAR[,4] * pca$rotation[4,2] + pcanormAR[,5] * pca$rotation[5,2]
ARPC3 = pcanormAR[,1] * pca$rotation[1,3] + pcanormAR[,2] * pca$rotation[2,3] + pcanormAR[,3] * pca$rotation[3,3] + pcanormAR[,4] * pca$rotation[4,3] + pcanormAR[,5] * pca$rotation[5,3]

ESIAR = NULL
for (i in c(1:182)){
  ESIAR[i] =  interseccion + (beta1 * ARPC1[i]) + (beta2 * ARPC2[i]) + (beta3 * ARPC3[i])
}

ESIAR = ts(ESIAR, frequency = 12, start = c(2007,1), end = c(2022,2))
```
CANARIAS:
```{r}
serie_crisisCN = ts(crisisCN$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoCN = ts(desempleoCN$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraCN = ts(quiebraCN$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsCN = ts(infojobsCN$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarCN = ts(comprarCN$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisCN <- x13(serie_crisisCN, spec = "RSA5c")
mysa_desempleoCN <- x13(serie_desempleoCN, spec = "RSA5c")
mysa_quiebraCN <- x13(serie_quiebraCN, spec = "RSA5c")
mysa_infojobsCN <- x13(serie_infojobsCN, spec = "RSA5c")
mysa_comprarCN <- x13(serie_comprarCN, spec = "RSA5c")

dataCN = data.frame(mysa_crisisCN[["final"]][["series"]][,2], mysa_desempleoCN[["final"]][["series"]][,2], mysa_quiebraCN[["final"]][["series"]][,2], mysa_infojobsCN[["final"]][["series"]][,2], mysa_comprarCN[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormCN = dataCN
for (i in c(1:5)){
  t = (dataCN[,i]-mean(dataCN[,i])) / sd(dataCN[,i])
  pcanormCN[,i] = t
}
CNPC1 = pcanormCN[,1] * pca$rotation[1,1] + pcanormCN[,2] * pca$rotation[2,1] + pcanormCN[,3] * pca$rotation[3,1] + pcanormCN[,4] * pca$rotation[4,1] + pcanormCN[,5] * pca$rotation[5,1]
CNPC2 = pcanormCN[,1] * pca$rotation[1,2] + pcanormCN[,2] * pca$rotation[2,2] + pcanormCN[,3] * pca$rotation[3,2] + pcanormCN[,4] * pca$rotation[4,2] + pcanormCN[,5] * pca$rotation[5,2]
CNPC3 = pcanormCN[,1] * pca$rotation[1,3] + pcanormCN[,2] * pca$rotation[2,3] + pcanormCN[,3] * pca$rotation[3,3] + pcanormCN[,4] * pca$rotation[4,3] + pcanormCN[,5] * pca$rotation[5,3]

ESICN = NULL
for (i in c(1:182)){
  ESICN[i] =  interseccion + (beta1 * CNPC1[i]) + (beta2 * CNPC2[i]) + (beta3 * CNPC3[i])
}

ESICN = ts(ESICN, frequency = 12, start = c(2007,1), end = c(2022,2))
```
CANTABRIA:
```{r}
serie_crisisCB = ts(crisisCB$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoCB = ts(desempleoCB$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraCB = ts(quiebraCB$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsCB = ts(infojobsCB$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarCB = ts(comprarCB$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisCB <- x13(serie_crisisCB, spec = "RSA5c")
mysa_desempleoCB <- x13(serie_desempleoCB, spec = "RSA5c")
mysa_quiebraCB <- x13(serie_quiebraCB, spec = "RSA5c")
mysa_infojobsCB <- x13(serie_infojobsCB, spec = "RSA5c")
mysa_comprarCB <- x13(serie_comprarCB, spec = "RSA5c")

dataCB = data.frame(mysa_crisisCB[["final"]][["series"]][,2], mysa_desempleoCB[["final"]][["series"]][,2], mysa_quiebraCB[["final"]][["series"]][,2], mysa_infojobsCB[["final"]][["series"]][,2], mysa_comprarCB[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormCB = dataCB
for (i in c(1:5)){
  t = (dataCB[,i]-mean(dataCB[,i])) / sd(dataCB[,i])
  pcanormCB[,i] = t
}
CBPC1 = pcanormCB[,1] * pca$rotation[1,1] + pcanormCB[,2] * pca$rotation[2,1] + pcanormCB[,3] * pca$rotation[3,1] + pcanormCB[,4] * pca$rotation[4,1] + pcanormCB[,5] * pca$rotation[5,1]
CBPC2 = pcanormCB[,1] * pca$rotation[1,2] + pcanormCB[,2] * pca$rotation[2,2] + pcanormCB[,3] * pca$rotation[3,2] + pcanormCB[,4] * pca$rotation[4,2] + pcanormCB[,5] * pca$rotation[5,2]
CBPC3 = pcanormCB[,1] * pca$rotation[1,3] + pcanormCB[,2] * pca$rotation[2,3] + pcanormCB[,3] * pca$rotation[3,3] + pcanormCB[,4] * pca$rotation[4,3] + pcanormCB[,5] * pca$rotation[5,3]

ESICB = NULL
for (i in c(1:182)){
  ESICB[i] =  interseccion + (beta1 * CBPC1[i]) + (beta2 * CBPC2[i]) + (beta3 * CBPC3[i])
}

ESICB = ts(ESICB, frequency = 12, start = c(2007,1), end = c(2022,2))
```
CASTILLA Y LEON:
```{r}
serie_crisisCL = ts(crisisCL$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoCL = ts(desempleoCL$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraCL = ts(quiebraCL$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsCL = ts(infojobsCL$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarCL = ts(comprarCL$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisCL <- x13(serie_crisisCL, spec = "RSA5c")
mysa_desempleoCL <- x13(serie_desempleoCL, spec = "RSA5c")
mysa_quiebraCL <- x13(serie_quiebraCL, spec = "RSA5c")
mysa_infojobsCL <- x13(serie_infojobsCL, spec = "RSA5c")
mysa_comprarCL <- x13(serie_comprarCL, spec = "RSA5c")

dataCL = data.frame(mysa_crisisCL[["final"]][["series"]][,2], mysa_desempleoCL[["final"]][["series"]][,2], mysa_quiebraCL[["final"]][["series"]][,2], mysa_infojobsCL[["final"]][["series"]][,2], mysa_comprarCL[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormCL = dataCL
for (i in c(1:5)){
  t = (dataCL[,i]-mean(dataCL[,i])) / sd(dataCL[,i])
  pcanormCL[,i] = t
}
CLPC1 = pcanormCL[,1] * pca$rotation[1,1] + pcanormCL[,2] * pca$rotation[2,1] + pcanormCL[,3] * pca$rotation[3,1] + pcanormCL[,4] * pca$rotation[4,1] + pcanormCL[,5] * pca$rotation[5,1]
CLPC2 = pcanormCL[,1] * pca$rotation[1,2] + pcanormCL[,2] * pca$rotation[2,2] + pcanormCL[,3] * pca$rotation[3,2] + pcanormCL[,4] * pca$rotation[4,2] + pcanormCL[,5] * pca$rotation[5,2]
CLPC3 = pcanormCL[,1] * pca$rotation[1,3] + pcanormCL[,2] * pca$rotation[2,3] + pcanormCL[,3] * pca$rotation[3,3] + pcanormCL[,4] * pca$rotation[4,3] + pcanormCL[,5] * pca$rotation[5,3]

ESICL = NULL
for (i in c(1:182)){
  ESICL[i] =  interseccion + (beta1 * CLPC1[i]) + (beta2 * CLPC2[i]) + (beta3 * CLPC3[i])
}

ESICL = ts(ESICL, frequency = 12, start = c(2007,1), end = c(2022,2))
```
CASTILLA LA MANCHA:
```{r}
serie_crisisCM = ts(crisisCM$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoCM = ts(desempleoCM$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraCM = ts(quiebraCM$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsCM = ts(infojobsCM$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarCM = ts(comprarCM$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisCM <- x13(serie_crisisCM, spec = "RSA5c")
mysa_desempleoCM <- x13(serie_desempleoCM, spec = "RSA5c")
mysa_quiebraCM <- x13(serie_quiebraCM, spec = "RSA5c")
mysa_infojobsCM <- x13(serie_infojobsCM, spec = "RSA5c")
mysa_comprarCM <- x13(serie_comprarCM, spec = "RSA5c")

dataCM = data.frame(mysa_crisisCM[["final"]][["series"]][,2], mysa_desempleoCM[["final"]][["series"]][,2], mysa_quiebraCM[["final"]][["series"]][,2], mysa_infojobsCM[["final"]][["series"]][,2], mysa_comprarCM[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormCM = dataCM
for (i in c(1:5)){
  t = (dataCM[,i]-mean(dataCM[,i])) / sd(dataCM[,i])
  pcanormCM[,i] = t
}
CMPC1 = pcanormCM[,1] * pca$rotation[1,1] + pcanormCM[,2] * pca$rotation[2,1] + pcanormCM[,3] * pca$rotation[3,1] + pcanormCM[,4] * pca$rotation[4,1] + pcanormCM[,5] * pca$rotation[5,1]
CMPC2 = pcanormCM[,1] * pca$rotation[1,2] + pcanormCM[,2] * pca$rotation[2,2] + pcanormCM[,3] * pca$rotation[3,2] + pcanormCM[,4] * pca$rotation[4,2] + pcanormCM[,5] * pca$rotation[5,2]
CMPC3 = pcanormCM[,1] * pca$rotation[1,3] + pcanormCM[,2] * pca$rotation[2,3] + pcanormCM[,3] * pca$rotation[3,3] + pcanormCM[,4] * pca$rotation[4,3] + pcanormCM[,5] * pca$rotation[5,3]

ESICM = NULL
for (i in c(1:182)){
  ESICM[i] =  interseccion + (beta1 * CMPC1[i]) + (beta2 * CMPC2[i]) + (beta3 * CMPC3[i])
}

ESICM = ts(ESICM, frequency = 12, start = c(2007,1), end = c(2022,2))
```
CATALUÑA:
```{r}
serie_crisisCT = ts(crisisCT$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoCT = ts(desempleoCT$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraCT = ts(quiebraCT$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsCT = ts(infojobsCT$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarCT = ts(comprarCT$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisCT <- x13(serie_crisisCT, spec = "RSA5c")
mysa_desempleoCT <- x13(serie_desempleoCT, spec = "RSA5c")
mysa_quiebraCT <- x13(serie_quiebraCT, spec = "RSA5c")
mysa_infojobsCT <- x13(serie_infojobsCT, spec = "RSA5c")
mysa_comprarCT <- x13(serie_comprarCT, spec = "RSA5c")

dataCT = data.frame(mysa_crisisCT[["final"]][["series"]][,2], mysa_desempleoCT[["final"]][["series"]][,2], mysa_quiebraCT[["final"]][["series"]][,2], mysa_infojobsCT[["final"]][["series"]][,2], mysa_comprarCT[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormCT = dataCT
for (i in c(1:5)){
  t = (dataCT[,i]-mean(dataCT[,i])) / sd(dataCT[,i])
  pcanormCT[,i] = t
}
CTPC1 = pcanormCT[,1] * pca$rotation[1,1] + pcanormCT[,2] * pca$rotation[2,1] + pcanormCT[,3] * pca$rotation[3,1] + pcanormCT[,4] * pca$rotation[4,1] + pcanormCT[,5] * pca$rotation[5,1]
CTPC2 = pcanormCT[,1] * pca$rotation[1,2] + pcanormCT[,2] * pca$rotation[2,2] + pcanormCT[,3] * pca$rotation[3,2] + pcanormCT[,4] * pca$rotation[4,2] + pcanormCT[,5] * pca$rotation[5,2]
CTPC3 = pcanormCT[,1] * pca$rotation[1,3] + pcanormCT[,2] * pca$rotation[2,3] + pcanormCT[,3] * pca$rotation[3,3] + pcanormCT[,4] * pca$rotation[4,3] + pcanormCT[,5] * pca$rotation[5,3]

ESICT = NULL
for (i in c(1:182)){
  ESICT[i] =  interseccion + (beta1 * CTPC1[i]) + (beta2 * CTPC2[i]) + (beta3 * CTPC3[i])
}

ESICT = ts(ESICT, frequency = 12, start = c(2007,1), end = c(2022,2))
```
CEUTA:
```{r}
#Ceuta no se puede hay muy pocos valores en la serie quiebra
```
EXTREMADURA:
```{r}
serie_crisisEX = ts(crisisEX$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoEX = ts(desempleoEX$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraEX = ts(quiebraEX$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsEX = ts(infojobsEX$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarEX = ts(comprarEX$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisEX <- x13(serie_crisisEX, spec = "RSA5c")
mysa_desempleoEX <- x13(serie_desempleoEX, spec = "RSA5c")
mysa_quiebraEX <- x13(serie_quiebraEX, spec = "RSA5c")
mysa_infojobsEX <- x13(serie_infojobsEX, spec = "RSA5c")
mysa_comprarEX <- x13(serie_comprarEX, spec = "RSA5c")

dataEX = data.frame(mysa_crisisEX[["final"]][["series"]][,2], mysa_desempleoEX[["final"]][["series"]][,2], mysa_quiebraEX[["final"]][["series"]][,2], mysa_infojobsEX[["final"]][["series"]][,2], mysa_comprarEX[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormEX = dataEX
for (i in c(1:5)){
  t = (dataEX[,i]-mean(dataEX[,i])) / sd(dataEX[,i])
  pcanormEX[,i] = t
}
EXPC1 = pcanormEX[,1] * pca$rotation[1,1] + pcanormEX[,2] * pca$rotation[2,1] + pcanormEX[,3] * pca$rotation[3,1] + pcanormEX[,4] * pca$rotation[4,1] + pcanormEX[,5] * pca$rotation[5,1]
EXPC2 = pcanormEX[,1] * pca$rotation[1,2] + pcanormEX[,2] * pca$rotation[2,2] + pcanormEX[,3] * pca$rotation[3,2] + pcanormEX[,4] * pca$rotation[4,2] + pcanormEX[,5] * pca$rotation[5,2]
EXPC3 = pcanormEX[,1] * pca$rotation[1,3] + pcanormEX[,2] * pca$rotation[2,3] + pcanormEX[,3] * pca$rotation[3,3] + pcanormEX[,4] * pca$rotation[4,3] + pcanormEX[,5] * pca$rotation[5,3]

ESIEX = NULL
for (i in c(1:182)){
  ESIEX[i] =  interseccion + (beta1 * EXPC1[i]) + (beta2 * EXPC2[i]) + (beta3 * EXPC3[i])
}

ESIEX = ts(ESIEX, frequency = 12, start = c(2007,1), end = c(2022,2))
```

GALICIA:
```{r}
serie_crisisGA = ts(crisisGA$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoGA = ts(desempleoGA$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraGA = ts(quiebraGA$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsGA = ts(infojobsGA$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarGA = ts(comprarGA$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisGA <- x13(serie_crisisGA, spec = "RSA5c")
mysa_desempleoGA <- x13(serie_desempleoGA, spec = "RSA5c")
mysa_quiebraGA <- x13(serie_quiebraGA, spec = "RSA5c")
mysa_infojobsGA <- x13(serie_infojobsGA, spec = "RSA5c")
mysa_comprarGA <- x13(serie_comprarGA, spec = "RSA5c")

dataGA = data.frame(mysa_crisisGA[["final"]][["series"]][,2], mysa_desempleoGA[["final"]][["series"]][,2], mysa_quiebraGA[["final"]][["series"]][,2], mysa_infojobsGA[["final"]][["series"]][,2], mysa_comprarGA[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormGA = dataGA
for (i in c(1:5)){
  t = (dataGA[,i]-mean(dataGA[,i])) / sd(dataGA[,i])
  pcanormGA[,i] = t
}
GAPC1 = pcanormGA[,1] * pca$rotation[1,1] + pcanormGA[,2] * pca$rotation[2,1] + pcanormGA[,3] * pca$rotation[3,1] + pcanormGA[,4] * pca$rotation[4,1] + pcanormGA[,5] * pca$rotation[5,1]
GAPC2 = pcanormGA[,1] * pca$rotation[1,2] + pcanormGA[,2] * pca$rotation[2,2] + pcanormGA[,3] * pca$rotation[3,2] + pcanormGA[,4] * pca$rotation[4,2] + pcanormGA[,5] * pca$rotation[5,2]
GAPC3 = pcanormGA[,1] * pca$rotation[1,3] + pcanormGA[,2] * pca$rotation[2,3] + pcanormGA[,3] * pca$rotation[3,3] + pcanormGA[,4] * pca$rotation[4,3] + pcanormGA[,5] * pca$rotation[5,3]

ESIGA = NULL
for (i in c(1:182)){
  ESIGA[i] =  interseccion + (beta1 * GAPC1[i]) + (beta2 * GAPC2[i]) + (beta3 * GAPC3[i])
}

ESIGA = ts(ESIGA, frequency = 12, start = c(2007,1), end = c(2022,2))
```
ISLAS BALEARES:
```{r}
serie_crisisIB = ts(crisisIB$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoIB = ts(desempleoIB$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraIB = ts(quiebraIB$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsIB = ts(infojobsIB$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarIB = ts(comprarIB$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisIB <- x13(serie_crisisIB, spec = "RSA5c")
mysa_desempleoIB <- x13(serie_desempleoIB, spec = "RSA5c")
mysa_quiebraIB <- x13(serie_quiebraIB, spec = "RSA5c")
mysa_infojobsIB <- x13(serie_infojobsIB, spec = "RSA5c")
mysa_comprarIB <- x13(serie_comprarIB, spec = "RSA5c")

dataIB = data.frame(mysa_crisisIB[["final"]][["series"]][,2], mysa_desempleoIB[["final"]][["series"]][,2], mysa_quiebraIB[["final"]][["series"]][,2], mysa_infojobsIB[["final"]][["series"]][,2], mysa_comprarIB[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormIB = dataIB
for (i in c(1:5)){
  t = (dataIB[,i]-mean(dataIB[,i])) / sd(dataIB[,i])
  pcanormIB[,i] = t
}
IBPC1 = pcanormIB[,1] * pca$rotation[1,1] + pcanormIB[,2] * pca$rotation[2,1] + pcanormIB[,3] * pca$rotation[3,1] + pcanormIB[,4] * pca$rotation[4,1] + pcanormIB[,5] * pca$rotation[5,1]
IBPC2 = pcanormIB[,1] * pca$rotation[1,2] + pcanormIB[,2] * pca$rotation[2,2] + pcanormIB[,3] * pca$rotation[3,2] + pcanormIB[,4] * pca$rotation[4,2] + pcanormIB[,5] * pca$rotation[5,2]
IBPC3 = pcanormIB[,1] * pca$rotation[1,3] + pcanormIB[,2] * pca$rotation[2,3] + pcanormIB[,3] * pca$rotation[3,3] + pcanormIB[,4] * pca$rotation[4,3] + pcanormIB[,5] * pca$rotation[5,3]

ESIIB = NULL
for (i in c(1:182)){
  ESIIB[i] =  interseccion + (beta1 * IBPC1[i]) + (beta2 * IBPC2[i]) + (beta3 * IBPC3[i])
}

ESIIB = ts(ESIIB, frequency = 12, start = c(2007,1), end = c(2022,2))
```
LA RIOJA:
```{r}
serie_crisisRI = ts(crisisRI$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoRI = ts(desempleoRI$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraRI = ts(quiebraRI$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsRI = ts(infojobsRI$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarRI = ts(comprarRI$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisRI <- x13(serie_crisisRI, spec = "RSA5c")
mysa_desempleoRI <- x13(serie_desempleoRI, spec = "RSA5c")
mysa_quiebraRI <- x13(serie_quiebraRI, spec = "RSA5c")
mysa_infojobsRI <- x13(serie_infojobsRI, spec = "RSA5c")
mysa_comprarRI <- x13(serie_comprarRI, spec = "RSA5c")

dataRI = data.frame(mysa_crisisRI[["final"]][["series"]][,2], mysa_desempleoRI[["final"]][["series"]][,2], mysa_quiebraRI[["final"]][["series"]][,2], mysa_infojobsRI[["final"]][["series"]][,2], mysa_comprarRI[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormRI = dataRI
for (i in c(1:5)){
  t = (dataRI[,i]-mean(dataRI[,i])) / sd(dataRI[,i])
  pcanormRI[,i] = t
}
RIPC1 = pcanormRI[,1] * pca$rotation[1,1] + pcanormRI[,2] * pca$rotation[2,1] + pcanormRI[,3] * pca$rotation[3,1] + pcanormRI[,4] * pca$rotation[4,1] + pcanormRI[,5] * pca$rotation[5,1]
RIPC2 = pcanormRI[,1] * pca$rotation[1,2] + pcanormRI[,2] * pca$rotation[2,2] + pcanormRI[,3] * pca$rotation[3,2] + pcanormRI[,4] * pca$rotation[4,2] + pcanormRI[,5] * pca$rotation[5,2]
RIPC3 = pcanormRI[,1] * pca$rotation[1,3] + pcanormRI[,2] * pca$rotation[2,3] + pcanormRI[,3] * pca$rotation[3,3] + pcanormRI[,4] * pca$rotation[4,3] + pcanormRI[,5] * pca$rotation[5,3]

ESIRI = NULL
for (i in c(1:182)){
  ESIRI[i] =  interseccion + (beta1 * RIPC1[i]) + (beta2 * RIPC2[i]) + (beta3 * RIPC3[i])
}

ESIRI = ts(ESIRI, frequency = 12, start = c(2007,1), end = c(2022,2))
```
MELILLA
```{r}
#MUY POCOS VALORES 
```
NAVARRA:
```{r}
serie_crisisNC = ts(crisisNC$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoNC = ts(desempleoNC$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraNC = ts(quiebraNC$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsNC = ts(infojobsNC$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarNC = ts(comprarNC$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisNC <- x13(serie_crisisNC, spec = "RSA5c")
mysa_desempleoNC <- x13(serie_desempleoNC, spec = "RSA5c")
mysa_quiebraNC <- x13(serie_quiebraNC, spec = "RSA5c")
mysa_infojobsNC <- x13(serie_infojobsNC, spec = "RSA5c")
mysa_comprarNC <- x13(serie_comprarNC, spec = "RSA5c")

dataNC = data.frame(mysa_crisisNC[["final"]][["series"]][,2], mysa_desempleoNC[["final"]][["series"]][,2], mysa_quiebraNC[["final"]][["series"]][,2], mysa_infojobsNC[["final"]][["series"]][,2], mysa_comprarNC[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormNC = dataNC
for (i in c(1:5)){
  t = (dataNC[,i]-mean(dataNC[,i])) / sd(dataNC[,i])
  pcanormNC[,i] = t
}
NCPC1 = pcanormNC[,1] * pca$rotation[1,1] + pcanormNC[,2] * pca$rotation[2,1] + pcanormNC[,3] * pca$rotation[3,1] + pcanormNC[,4] * pca$rotation[4,1] + pcanormNC[,5] * pca$rotation[5,1]
NCPC2 = pcanormNC[,1] * pca$rotation[1,2] + pcanormNC[,2] * pca$rotation[2,2] + pcanormNC[,3] * pca$rotation[3,2] + pcanormNC[,4] * pca$rotation[4,2] + pcanormNC[,5] * pca$rotation[5,2]
NCPC3 = pcanormNC[,1] * pca$rotation[1,3] + pcanormNC[,2] * pca$rotation[2,3] + pcanormNC[,3] * pca$rotation[3,3] + pcanormNC[,4] * pca$rotation[4,3] + pcanormNC[,5] * pca$rotation[5,3]

ESINC = NULL
for (i in c(1:182)){
  ESINC[i] =  interseccion + (beta1 * NCPC1[i]) + (beta2 * NCPC2[i]) + (beta3 * NCPC3[i])
}

ESINC = ts(ESINC, frequency = 12, start = c(2007,1), end = c(2022,2))
```
PAIS VASCO:
```{r}
serie_crisisPV = ts(crisisPV$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoPV = ts(desempleoPV$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraPV = ts(quiebraPV$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsPV = ts(infojobsPV$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarPV = ts(comprarPV$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisPV <- x13(serie_crisisPV, spec = "RSA5c")
mysa_desempleoPV <- x13(serie_desempleoPV, spec = "RSA5c")
mysa_quiebraPV <- x13(serie_quiebraPV, spec = "RSA5c")
mysa_infojobsPV <- x13(serie_infojobsPV, spec = "RSA5c")
mysa_comprarPV <- x13(serie_comprarPV, spec = "RSA5c")

dataPV = data.frame(mysa_crisisPV[["final"]][["series"]][,2], mysa_desempleoPV[["final"]][["series"]][,2], mysa_quiebraPV[["final"]][["series"]][,2], mysa_infojobsPV[["final"]][["series"]][,2], mysa_comprarPV[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormPV = dataPV
for (i in c(1:5)){
  t = (dataPV[,i]-mean(dataPV[,i])) / sd(dataPV[,i])
  pcanormPV[,i] = t
}
PVPC1 = pcanormPV[,1] * pca$rotation[1,1] + pcanormPV[,2] * pca$rotation[2,1] + pcanormPV[,3] * pca$rotation[3,1] + pcanormPV[,4] * pca$rotation[4,1] + pcanormPV[,5] * pca$rotation[5,1]
PVPC2 = pcanormPV[,1] * pca$rotation[1,2] + pcanormPV[,2] * pca$rotation[2,2] + pcanormPV[,3] * pca$rotation[3,2] + pcanormPV[,4] * pca$rotation[4,2] + pcanormPV[,5] * pca$rotation[5,2]
PVPC3 = pcanormPV[,1] * pca$rotation[1,3] + pcanormPV[,2] * pca$rotation[2,3] + pcanormPV[,3] * pca$rotation[3,3] + pcanormPV[,4] * pca$rotation[4,3] + pcanormPV[,5] * pca$rotation[5,3]

ESIPV = NULL
for (i in c(1:182)){
  ESIPV[i] =  interseccion + (beta1 * PVPC1[i]) + (beta2 * PVPC2[i]) + (beta3 * PVPC3[i])
}

ESIPV = ts(ESIPV, frequency = 12, start = c(2007,1), end = c(2022,2))
```
ASTURIAS:
```{r}
serie_crisisAS = ts(crisisAS$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoAS = ts(desempleoAS$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraAS = ts(quiebraAS$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsAS = ts(infojobsAS$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarAS = ts(comprarAS$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisAS <- x13(serie_crisisAS, spec = "RSA5c")
mysa_desempleoAS <- x13(serie_desempleoAS, spec = "RSA5c")
mysa_quiebraAS <- x13(serie_quiebraAS, spec = "RSA5c")
mysa_infojobsAS <- x13(serie_infojobsAS, spec = "RSA5c")
mysa_comprarAS <- x13(serie_comprarAS, spec = "RSA5c")

dataAS = data.frame(mysa_crisisAS[["final"]][["series"]][,2], mysa_desempleoAS[["final"]][["series"]][,2], mysa_quiebraAS[["final"]][["series"]][,2], mysa_infojobsAS[["final"]][["series"]][,2], mysa_comprarAS[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormAS = dataAS
for (i in c(1:5)){
  t = (dataAS[,i]-mean(dataAS[,i])) / sd(dataAS[,i])
  pcanormAS[,i] = t
}
ASPC1 = pcanormAS[,1] * pca$rotation[1,1] + pcanormAS[,2] * pca$rotation[2,1] + pcanormAS[,3] * pca$rotation[3,1] + pcanormAS[,4] * pca$rotation[4,1] + pcanormAS[,5] * pca$rotation[5,1]
ASPC2 = pcanormAS[,1] * pca$rotation[1,2] + pcanormAS[,2] * pca$rotation[2,2] + pcanormAS[,3] * pca$rotation[3,2] + pcanormAS[,4] * pca$rotation[4,2] + pcanormAS[,5] * pca$rotation[5,2]
ASPC3 = pcanormAS[,1] * pca$rotation[1,3] + pcanormAS[,2] * pca$rotation[2,3] + pcanormAS[,3] * pca$rotation[3,3] + pcanormAS[,4] * pca$rotation[4,3] + pcanormAS[,5] * pca$rotation[5,3]

ESIAS = NULL
for (i in c(1:182)){
  ESIAS[i] =  interseccion + (beta1 * ASPC1[i]) + (beta2 * ASPC2[i]) + (beta3 * ASPC3[i])
}

ESIAS = ts(ESIAS, frequency = 12, start = c(2007,1), end = c(2022,2))
```
MURCIA:
```{r}
serie_crisisMC = ts(crisisMC$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_desempleoMC = ts(desempleoMC$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_quiebraMC = ts(quiebraMC$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_infojobsMC = ts(infojobsMC$value, frequency = 12, start = c(2007,1), end = c(2022,2))
serie_comprarMC = ts(comprarMC$value, frequency = 12, start = c(2007,1), end = c(2022,2))

mysa_crisisMC <- x13(serie_crisisMC, spec = "RSA5c")
mysa_desempleoMC <- x13(serie_desempleoMC, spec = "RSA5c")
mysa_quiebraMC <- x13(serie_quiebraMC, spec = "RSA5c")
mysa_infojobsMC <- x13(serie_infojobsMC, spec = "RSA5c")
mysa_comprarMC <- x13(serie_comprarMC, spec = "RSA5c")

dataMC = data.frame(mysa_crisisMC[["final"]][["series"]][,2], mysa_desempleoMC[["final"]][["series"]][,2], mysa_quiebraMC[["final"]][["series"]][,2], mysa_infojobsMC[["final"]][["series"]][,2], mysa_comprarMC[["final"]][["series"]][,2])
#res.pcaVLC = PCA(dataVLC, scale.unit = TRUE, graph = FALSE, ncp = 5)
#Var_pcaVLC = res.pca[["ind"]][["coord"]]
pcanormMC = dataMC
for (i in c(1:5)){
  t = (dataMC[,i]-mean(dataMC[,i])) / sd(dataMC[,i])
  pcanormMC[,i] = t
}
MCPC1 = pcanormMC[,1] * pca$rotation[1,1] + pcanormMC[,2] * pca$rotation[2,1] + pcanormMC[,3] * pca$rotation[3,1] + pcanormMC[,4] * pca$rotation[4,1] + pcanormMC[,5] * pca$rotation[5,1]
MCPC2 = pcanormMC[,1] * pca$rotation[1,2] + pcanormMC[,2] * pca$rotation[2,2] + pcanormMC[,3] * pca$rotation[3,2] + pcanormMC[,4] * pca$rotation[4,2] + pcanormMC[,5] * pca$rotation[5,2]
MCPC3 = pcanormMC[,1] * pca$rotation[1,3] + pcanormMC[,2] * pca$rotation[2,3] + pcanormMC[,3] * pca$rotation[3,3] + pcanormMC[,4] * pca$rotation[4,3] + pcanormMC[,5] * pca$rotation[5,3]

ESIMC = NULL
for (i in c(1:182)){
  ESIMC[i] =  interseccion + (beta1 * MCPC1[i]) + (beta2 * MCPC2[i]) + (beta3 * MCPC3[i])
}

ESIMC = ts(ESIMC, frequency = 12, start = c(2007,1), end = c(2022,2))
```


COMUNIDADES:
```{r}

crisisVLC = ts_gtrends(keyword = 'crisis', geo = 'ES-VC', time = ('2007-01-01 2022-02-28'))
desempleoVLC = ts_gtrends(keyword = 'desempleo', geo = 'ES-VC', time = ('2007-01-01 2022-02-28'))
quiebraVLC = ts_gtrends(keyword = 'quiebra', geo = 'ES-VC', time = ('2007-01-01 2022-02-28'))
infojobsVLC = ts_gtrends(keyword = 'infojobs', geo = 'ES-VC', time = ('2007-01-01 2022-02-28'))
comprarVLC = ts_gtrends(keyword = 'comprar', geo = 'ES-VC', time = ('2007-01-01 2022-02-28'))

crisisMAD = ts_gtrends(keyword = 'crisis', geo = 'ES-MD', time = ('2007-01-01 2022-02-28'))
desempleoMAD = ts_gtrends(keyword = 'desempleo', geo = 'ES-MD', time = ('2007-01-01 2022-02-28'))
quiebraMAD = ts_gtrends(keyword = 'quiebra', geo = 'ES-MD', time = ('2007-01-01 2022-02-28'))
infojobsMAD = ts_gtrends(keyword = 'infojobs', geo = 'ES-MD', time = ('2007-01-01 2022-02-28'))
comprarMAD = ts_gtrends(keyword = 'comprar', geo = 'ES-MD', time = ('2007-01-01 2022-02-28'))

crisisAN = ts_gtrends(keyword = 'crisis', geo = 'ES-AN', time = ('2007-01-01 2022-02-28'))
desempleoAN = ts_gtrends(keyword = 'desempleo', geo = 'ES-AN', time = ('2007-01-01 2022-02-28'))
quiebraAN = ts_gtrends(keyword = 'quiebra', geo = 'ES-AN', time = ('2007-01-01 2022-02-28'))
infojobsAN = ts_gtrends(keyword = 'infojobs', geo = 'ES-AN', time = ('2007-01-01 2022-02-28'))
comprarAN = ts_gtrends(keyword = 'comprar', geo = 'ES-AN', time = ('2007-01-01 2022-02-28'))

crisisAR = ts_gtrends(keyword = 'crisis', geo = 'ES-AR', time = ('2007-01-01 2022-02-28'))
desempleoAR = ts_gtrends(keyword = 'desempleo', geo = 'ES-AR', time = ('2007-01-01 2022-02-28'))
quiebraAR = ts_gtrends(keyword = 'quiebra', geo = 'ES-AR', time = ('2007-01-01 2022-02-28'))
infojobsAR = ts_gtrends(keyword = 'infojobs', geo = 'ES-AR', time = ('2007-01-01 2022-02-28'))
comprarAR = ts_gtrends(keyword = 'comprar', geo = 'ES-AR', time = ('2007-01-01 2022-02-28'))

crisisCN = ts_gtrends(keyword = 'crisis', geo = 'ES-CN', time = ('2007-01-01 2022-02-28'))
desempleoCN = ts_gtrends(keyword = 'desempleo', geo = 'ES-CN', time = ('2007-01-01 2022-02-28'))
quiebraCN = ts_gtrends(keyword = 'quiebra', geo = 'ES-CN', time = ('2007-01-01 2022-02-28'))
infojobsCN = ts_gtrends(keyword = 'infojobs', geo = 'ES-CN', time = ('2007-01-01 2022-02-28'))
comprarCN = ts_gtrends(keyword = 'comprar', geo = 'ES-CN', time = ('2007-01-01 2022-02-28'))

crisisCB = ts_gtrends(keyword = 'crisis', geo = 'ES-CB', time = ('2007-01-01 2022-02-28'))
desempleoCB = ts_gtrends(keyword = 'desempleo', geo = 'ES-CB', time = ('2007-01-01 2022-02-28'))
quiebraCB = ts_gtrends(keyword = 'quiebra', geo = 'ES-CB', time = ('2007-01-01 2022-02-28'))
infojobsCB = ts_gtrends(keyword = 'infojobs', geo = 'ES-CB', time = ('2007-01-01 2022-02-28'))
comprarCB = ts_gtrends(keyword = 'comprar', geo = 'ES-CB', time = ('2007-01-01 2022-02-28'))

crisisCL = ts_gtrends(keyword = 'crisis', geo = 'ES-CL', time = ('2007-01-01 2022-02-28'))
desempleoCL = ts_gtrends(keyword = 'desempleo', geo = 'ES-CL', time = ('2007-01-01 2022-02-28'))
quiebraCL = ts_gtrends(keyword = 'quiebra', geo = 'ES-CL', time = ('2007-01-01 2022-02-28'))
infojobsCL = ts_gtrends(keyword = 'infojobs', geo = 'ES-CL', time = ('2007-01-01 2022-02-28'))
comprarCL = ts_gtrends(keyword = 'comprar', geo = 'ES-CL', time = ('2007-01-01 2022-02-28'))

crisisCM = ts_gtrends(keyword = 'crisis', geo = 'ES-CM', time = ('2007-01-01 2022-02-28'))
desempleoCM = ts_gtrends(keyword = 'desempleo', geo = 'ES-CM', time = ('2007-01-01 2022-02-28'))
quiebraCM = ts_gtrends(keyword = 'quiebra', geo = 'ES-CM', time = ('2007-01-01 2022-02-28'))
infojobsCM = ts_gtrends(keyword = 'infojobs', geo = 'ES-CM', time = ('2007-01-01 2022-02-28'))
comprarCM = ts_gtrends(keyword = 'comprar', geo = 'ES-CM', time = ('2007-01-01 2022-02-28'))

crisisCT = ts_gtrends(keyword = 'crisis', geo = 'ES-CT', time = ('2007-01-01 2022-02-28'))
desempleoCT = ts_gtrends(keyword = 'desempleo', geo = 'ES-CT', time = ('2007-01-01 2022-02-28'))
quiebraCT = ts_gtrends(keyword = 'quiebra', geo = 'ES-CT', time = ('2007-01-01 2022-02-28'))
infojobsCT = ts_gtrends(keyword = 'infojobs', geo = 'ES-CT', time = ('2007-01-01 2022-02-28'))
comprarCT = ts_gtrends(keyword = 'comprar', geo = 'ES-CT', time = ('2007-01-01 2022-02-28'))

crisisCE = ts_gtrends(keyword = 'crisis', geo = 'ES-CE', time = ('2007-01-01 2022-02-28'))
desempleoCE = ts_gtrends(keyword = 'desempleo', geo = 'ES-CE', time = ('2007-01-01 2022-02-28'))
quiebraCE = ts_gtrends(keyword = 'quiebra', geo = 'ES-CE', time = ('2007-01-01 2022-02-28'))
infojobsCE = ts_gtrends(keyword = 'infojobs', geo = 'ES-CE', time = ('2007-01-01 2022-02-28'))
comprarCE = ts_gtrends(keyword = 'comprar', geo = 'ES-CE', time = ('2007-01-01 2022-02-28'))

crisisEX = ts_gtrends(keyword = 'crisis', geo = 'ES-EX', time = ('2007-01-01 2022-02-28'))
desempleoEX = ts_gtrends(keyword = 'desempleo', geo = 'ES-EX', time = ('2007-01-01 2022-02-28'))
quiebraEX = ts_gtrends(keyword = 'quiebra', geo = 'ES-EX', time = ('2007-01-01 2022-02-28'))
infojobsEX = ts_gtrends(keyword = 'infojobs', geo = 'ES-EX', time = ('2007-01-01 2022-02-28'))
comprarEX = ts_gtrends(keyword = 'comprar', geo = 'ES-EX', time = ('2007-01-01 2022-02-28'))

crisisGA = ts_gtrends(keyword = 'crisis', geo = 'ES-GA', time = ('2007-01-01 2022-02-28'))
desempleoGA = ts_gtrends(keyword = 'desempleo', geo = 'ES-GA', time = ('2007-01-01 2022-02-28'))
quiebraGA = ts_gtrends(keyword = 'quiebra', geo = 'ES-GA', time = ('2007-01-01 2022-02-28'))
infojobsGA = ts_gtrends(keyword = 'infojobs', geo = 'ES-GA', time = ('2007-01-01 2022-02-28'))
comprarGA = ts_gtrends(keyword = 'comprar', geo = 'ES-GA', time = ('2007-01-01 2022-02-28'))

crisisIB = ts_gtrends(keyword = 'crisis', geo = 'ES-IB', time = ('2007-01-01 2022-02-28'))
desempleoIB = ts_gtrends(keyword = 'desempleo', geo = 'ES-IB', time = ('2007-01-01 2022-02-28'))
quiebraIB = ts_gtrends(keyword = 'quiebra', geo = 'ES-IB', time = ('2007-01-01 2022-02-28'))
infojobsIB = ts_gtrends(keyword = 'infojobs', geo = 'ES-IB', time = ('2007-01-01 2022-02-28'))
comprarIB = ts_gtrends(keyword = 'comprar', geo = 'ES-IB', time = ('2007-01-01 2022-02-28'))

crisisRI = ts_gtrends(keyword = 'crisis', geo = 'ES-RI', time = ('2007-01-01 2022-02-28'))
desempleoRI = ts_gtrends(keyword = 'desempleo', geo = 'ES-RI', time = ('2007-01-01 2022-02-28'))
quiebraRI = ts_gtrends(keyword = 'quiebra', geo = 'ES-RI', time = ('2007-01-01 2022-02-28'))
infojobsRI = ts_gtrends(keyword = 'infojobs', geo = 'ES-RI', time = ('2007-01-01 2022-02-28'))
comprarRI = ts_gtrends(keyword = 'comprar', geo = 'ES-RI', time = ('2007-01-01 2022-02-28'))

crisisML = ts_gtrends(keyword = 'crisis', geo = 'ES-ML', time = ('2007-01-01 2022-02-28'))
desempleoML = ts_gtrends(keyword = 'desempleo', geo = 'ES-ML', time = ('2007-01-01 2022-02-28'))
quiebraML = ts_gtrends(keyword = 'quiebra', geo = 'ES-ML', time = ('2007-01-01 2022-02-28'))
infojobsML = ts_gtrends(keyword = 'infojobs', geo = 'ES-ML', time = ('2007-01-01 2022-02-28'))
comprarML = ts_gtrends(keyword = 'comprar', geo = 'ES-ML', time = ('2007-01-01 2022-02-28'))

crisisNC = ts_gtrends(keyword = 'crisis', geo = 'ES-NC', time = ('2007-01-01 2022-02-28'))
desempleoNC = ts_gtrends(keyword = 'desempleo', geo = 'ES-NC', time = ('2007-01-01 2022-02-28'))
quiebraNC = ts_gtrends(keyword = 'quiebra', geo = 'ES-NC', time = ('2007-01-01 2022-02-28'))
infojobsNC = ts_gtrends(keyword = 'infojobs', geo = 'ES-NC', time = ('2007-01-01 2022-02-28'))
comprarNC = ts_gtrends(keyword = 'comprar', geo = 'ES-NC', time = ('2007-01-01 2022-02-28'))

crisisPV = ts_gtrends(keyword = 'crisis', geo = 'ES-PV', time = ('2007-01-01 2022-02-28'))
desempleoPV = ts_gtrends(keyword = 'desempleo', geo = 'ES-PV', time = ('2007-01-01 2022-02-28'))
quiebraPV = ts_gtrends(keyword = 'quiebra', geo = 'ES-PV', time = ('2007-01-01 2022-02-28'))
infojobsPV = ts_gtrends(keyword = 'infojobs', geo = 'ES-PV', time = ('2007-01-01 2022-02-28'))
comprarPV = ts_gtrends(keyword = 'comprar', geo = 'ES-PV', time = ('2007-01-01 2022-02-28'))

crisisAS = ts_gtrends(keyword = 'crisis', geo = 'ES-AS', time = ('2007-01-01 2022-02-28'))
desempleoAS = ts_gtrends(keyword = 'desempleo', geo = 'ES-AS', time = ('2007-01-01 2022-02-28'))
quiebraAS = ts_gtrends(keyword = 'quiebra', geo = 'ES-AS', time = ('2007-01-01 2022-02-28'))
infojobsAS = ts_gtrends(keyword = 'infojobs', geo = 'ES-AS', time = ('2007-01-01 2022-02-28'))
comprarAS = ts_gtrends(keyword = 'comprar', geo = 'ES-AS', time = ('2007-01-01 2022-02-28'))

crisisMC = ts_gtrends(keyword = 'crisis', geo = 'ES-MC', time = ('2007-01-01 2022-02-28'))
desempleoMC = ts_gtrends(keyword = 'desempleo', geo = 'ES-MC', time = ('2007-01-01 2022-02-28'))
quiebraMC = ts_gtrends(keyword = 'quiebra', geo = 'ES-MC', time = ('2007-01-01 2022-02-28'))
infojobsMC = ts_gtrends(keyword = 'infojobs', geo = 'ES-MC', time = ('2007-01-01 2022-02-28'))
comprarMC = ts_gtrends(keyword = 'comprar', geo = 'ES-MC', time = ('2007-01-01 2022-02-28'))
```


```{r}
crisisVLC1 = ts_gtrends(keyword = 'crisis', geo = 'ES-VC', time = ('2007-01-01 2022-02-28'))
desempleoVLC1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-VC', time = ('2007-01-01 2022-02-28'))
quiebraVLC1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-VC', time = ('2007-01-01 2022-02-28'))
infojobsVLC1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-VC', time = ('2007-01-01 2022-02-28'))
comprarVLC1 = ts_gtrends(keyword = 'comprar', geo = 'ES-VC', time = ('2007-01-01 2022-02-28'))

crisisMAD1 = ts_gtrends(keyword = 'crisis', geo = 'ES-MD', time = ('2007-01-01 2022-02-28'))
desempleoMAD1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-MD', time = ('2007-01-01 2022-02-28'))
quiebraMAD1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-MD', time = ('2007-01-01 2022-02-28'))
infojobsMAD1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-MD', time = ('2007-01-01 2022-02-28'))
comprarMAD1= ts_gtrends(keyword = 'comprar', geo = 'ES-MD', time = ('2007-01-01 2022-02-28'))

crisisAN1 = ts_gtrends(keyword = 'crisis', geo = 'ES-AN', time = ('2007-01-01 2022-02-28'))
desempleoAN1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-AN', time = ('2007-01-01 2022-02-28'))
quiebraAN1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-AN', time = ('2007-01-01 2022-02-28'))
infojobsAN1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-AN', time = ('2007-01-01 2022-02-28'))
comprarAN1 = ts_gtrends(keyword = 'comprar', geo = 'ES-AN', time = ('2007-01-01 2022-02-28'))

crisisAR1 = ts_gtrends(keyword = 'crisis', geo = 'ES-AR', time = ('2007-01-01 2022-02-28'))
desempleoAR1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-AR', time = ('2007-01-01 2022-02-28'))
quiebraAR1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-AR', time = ('2007-01-01 2022-02-28'))
infojobsAR1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-AR', time = ('2007-01-01 2022-02-28'))
comprarAR1 = ts_gtrends(keyword = 'comprar', geo = 'ES-AR', time = ('2007-01-01 2022-02-28'))

crisisCN1 = ts_gtrends(keyword = 'crisis', geo = 'ES-CN', time = ('2007-01-01 2022-02-28'))
desempleoCN1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-CN', time = ('2007-01-01 2022-02-28'))
quiebraCN1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-CN', time = ('2007-01-01 2022-02-28'))
infojobsCN1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-CN', time = ('2007-01-01 2022-02-28'))
comprarCN1 = ts_gtrends(keyword = 'comprar', geo = 'ES-CN', time = ('2007-01-01 2022-02-28'))

crisisCB1 = ts_gtrends(keyword = 'crisis', geo = 'ES-CB', time = ('2007-01-01 2022-02-28'))
desempleoCB1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-CB', time = ('2007-01-01 2022-02-28'))
quiebraCB1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-CB', time = ('2007-01-01 2022-02-28'))
infojobsCB1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-CB', time = ('2007-01-01 2022-02-28'))
comprarCB1 = ts_gtrends(keyword = 'comprar', geo = 'ES-CB', time = ('2007-01-01 2022-02-28'))

crisisCL1 = ts_gtrends(keyword = 'crisis', geo = 'ES-CL', time = ('2007-01-01 2022-02-28'))
desempleoCL1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-CL', time = ('2007-01-01 2022-02-28'))
quiebraCL1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-CL', time = ('2007-01-01 2022-02-28'))
infojobsCL1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-CL', time = ('2007-01-01 2022-02-28'))
comprarCL1 = ts_gtrends(keyword = 'comprar', geo = 'ES-CL', time = ('2007-01-01 2022-02-28'))

crisisCM1 = ts_gtrends(keyword = 'crisis', geo = 'ES-CM', time = ('2007-01-01 2022-02-28'))
desempleoCM1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-CM', time = ('2007-01-01 2022-02-28'))
quiebraCM1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-CM', time = ('2007-01-01 2022-02-28'))
infojobsCM1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-CM', time = ('2007-01-01 2022-02-28'))
comprarCM1 = ts_gtrends(keyword = 'comprar', geo = 'ES-CM', time = ('2007-01-01 2022-02-28'))

crisisCT1 = ts_gtrends(keyword = 'crisis', geo = 'ES-CT', time = ('2007-01-01 2022-02-28'))
desempleoCT1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-CT', time = ('2007-01-01 2022-02-28'))
quiebraCT1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-CT', time = ('2007-01-01 2022-02-28'))
infojobsCT1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-CT', time = ('2007-01-01 2022-02-28'))
comprarCT1 = ts_gtrends(keyword = 'comprar', geo = 'ES-CT', time = ('2007-01-01 2022-02-28'))

crisisCE1 = ts_gtrends(keyword = 'crisis', geo = 'ES-CE', time = ('2007-01-01 2022-02-28'))
desempleoCE1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-CE', time = ('2007-01-01 2022-02-28'))
quiebraCE1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-CE', time = ('2007-01-01 2022-02-28'))
infojobsCE1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-CE', time = ('2007-01-01 2022-02-28'))
comprarCE1 = ts_gtrends(keyword = 'comprar', geo = 'ES-CE', time = ('2007-01-01 2022-02-28'))

crisisEX1 = ts_gtrends(keyword = 'crisis', geo = 'ES-EX', time = ('2007-01-01 2022-02-28'))
desempleoEX1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-EX', time = ('2007-01-01 2022-02-28'))
quiebraEX1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-EX', time = ('2007-01-01 2022-02-28'))
infojobsEX1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-EX', time = ('2007-01-01 2022-02-28'))
comprarEX1 = ts_gtrends(keyword = 'comprar', geo = 'ES-EX', time = ('2007-01-01 2022-02-28'))

crisisGA1 = ts_gtrends(keyword = 'crisis', geo = 'ES-GA', time = ('2007-01-01 2022-02-28'))
desempleoGA1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-GA', time = ('2007-01-01 2022-02-28'))
quiebraGA1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-GA', time = ('2007-01-01 2022-02-28'))
infojobsGA1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-GA', time = ('2007-01-01 2022-02-28'))
comprarGA1 = ts_gtrends(keyword = 'comprar', geo = 'ES-GA', time = ('2007-01-01 2022-02-28'))

crisisIB1 = ts_gtrends(keyword = 'crisis', geo = 'ES-IB', time = ('2007-01-01 2022-02-28'))
desempleoIB1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-IB', time = ('2007-01-01 2022-02-28'))
quiebraIB1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-IB', time = ('2007-01-01 2022-02-28'))
infojobsIB1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-IB', time = ('2007-01-01 2022-02-28'))
comprarIB1 = ts_gtrends(keyword = 'comprar', geo = 'ES-IB', time = ('2007-01-01 2022-02-28'))

crisisRI1 = ts_gtrends(keyword = 'crisis', geo = 'ES-RI', time = ('2007-01-01 2022-02-28'))
desempleoRI1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-RI', time = ('2007-01-01 2022-02-28'))
quiebraRI1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-RI', time = ('2007-01-01 2022-02-28'))
infojobsRI1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-RI', time = ('2007-01-01 2022-02-28'))
comprarRI1 = ts_gtrends(keyword = 'comprar', geo = 'ES-RI', time = ('2007-01-01 2022-02-28'))

crisisML1 = ts_gtrends(keyword = 'crisis', geo = 'ES-ML', time = ('2007-01-01 2022-02-28'))
desempleoML1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-ML', time = ('2007-01-01 2022-02-28'))
quiebraML1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-ML', time = ('2007-01-01 2022-02-28'))
infojobsML1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-ML', time = ('2007-01-01 2022-02-28'))
comprarML1 = ts_gtrends(keyword = 'comprar', geo = 'ES-ML', time = ('2007-01-01 2022-02-28'))

crisisNC1 = ts_gtrends(keyword = 'crisis', geo = 'ES-NC', time = ('2007-01-01 2022-02-28'))
desempleoNC1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-NC', time = ('2007-01-01 2022-02-28'))
quiebraNC1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-NC', time = ('2007-01-01 2022-02-28'))
infojobsNC1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-NC', time = ('2007-01-01 2022-02-28'))
comprarNC1 = ts_gtrends(keyword = 'comprar', geo = 'ES-NC', time = ('2007-01-01 2022-02-28'))

crisisPV1 = ts_gtrends(keyword = 'crisis', geo = 'ES-PV', time = ('2007-01-01 2022-02-28'))
desempleoPV1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-PV', time = ('2007-01-01 2022-02-28'))
quiebraPV1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-PV', time = ('2007-01-01 2022-02-28'))
infojobsPV1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-PV', time = ('2007-01-01 2022-02-28'))
comprarPV1 = ts_gtrends(keyword = 'comprar', geo = 'ES-PV', time = ('2007-01-01 2022-02-28'))

crisisAS1 = ts_gtrends(keyword = 'crisis', geo = 'ES-AS', time = ('2007-01-01 2022-02-28'))
desempleoAS1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-AS', time = ('2007-01-01 2022-02-28'))
quiebraAS1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-AS', time = ('2007-01-01 2022-02-28'))
infojobsAS1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-AS', time = ('2007-01-01 2022-02-28'))
comprarAS1 = ts_gtrends(keyword = 'comprar', geo = 'ES-AS', time = ('2007-01-01 2022-02-28'))

crisisMC1 = ts_gtrends(keyword = 'crisis', geo = 'ES-MC', time = ('2007-01-01 2022-02-28'))
desempleoMC1 = ts_gtrends(keyword = 'desempleo', geo = 'ES-MC', time = ('2007-01-01 2022-02-28'))
quiebraMC1 = ts_gtrends(keyword = 'quiebra', geo = 'ES-MC', time = ('2007-01-01 2022-02-28'))
infojobsMC1 = ts_gtrends(keyword = 'infojobs', geo = 'ES-MC', time = ('2007-01-01 2022-02-28'))
comprarMC1 = ts_gtrends(keyword = 'comprar', geo = 'ES-MC', time = ('2007-01-01 2022-02-28'))
```
